diff --git a/net/packet/af_packet.c b/net/packet/af_packet.c
index 6f43de748bfb..cd11aecb6449 100644
--- a/net/packet/af_packet.c
+++ b/net/packet/af_packet.c
@@ -4359,8 +4359,9 @@ static int packet_set_ring(struct sock *sk, union tpacket_req_u *req_u,
                        goto out;
                min_frame_size = po->tp_hdrlen + po->tp_reserve;
                if (po->tp_version >= TPACKET_V3 &&
-                   req->tp_block_size <
-                   BLK_PLUS_PRIV((u64)req_u->req3.tp_sizeof_priv) + min_frame_size)
+            // (p0tr3c): CVE-2017-7308
+            (int)(req->tp_block_size -
+                BLK_PLUS_PRIV(req_u->req3.tp_sizeof_priv)) <= 0)
                        goto out;
                if (unlikely(req->tp_frame_size < min_frame_size))
                        goto out;
